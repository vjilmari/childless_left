---
title: "ERQ3 Gender moderations"
output: 
  html_document: 
    toc: yes
    keep_md: yes
date: '2022-05-02'
---


```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# Preparations

## Packages

```{r}
library(lme4)
library(emmeans)
library(rio)
library(dplyr)
library(vjihelpers)

```

## Custom functions

```{r}
source("../custom_functions.R")
source("../modglmer_logit.R")
```

## Data

```{r}
fdat<-import("../../data/processed/fdat.xlsx")
```

## Data exclusions

```{r}

PP.vars<-
  names(fdat)[which(names(fdat)=="lrgen.z"):
                which(names(fdat)=="corrupt_salience.z")]

exdat<-fdat %>%
  dplyr::select(childlessness,
                gndr.c,age10.c,
                minority.c,all_of(PP.vars),
                cntry,anweight) %>%
  na.omit()
```

## Variable centering

```{r}
exdat<-
  group_mean_center(
    data=exdat,group.var="cntry",
    vars=PP.vars,
    grand.init = F)

```


# ERQ3 Analysis 

## lrgen

### Fixed

```{r}
mod2.lrgen<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          lrgen.z.gmc+
          lrgen.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.lrgen)
```

### Random

```{r}
mod3.lrgen<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          lrgen.z.gmc+
          lrgen.z.gmc:gndr.c+
          (lrgen.z.gmc+gndr.c+lrgen.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.lrgen)

anova(mod2.lrgen,mod3.lrgen)
```


## lrecon

### Fixed

```{r}
mod2.lrecon<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          lrecon.z.gmc+
          lrecon.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.lrecon)
```

### Random

```{r}
mod3.lrecon<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          lrecon.z.gmc+
          lrecon.z.gmc:gndr.c+
          (lrecon.z.gmc+gndr.c+lrecon.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.lrecon)

anova(mod2.lrecon,mod3.lrecon)
```


## galtan

### Fixed

```{r}
mod2.galtan<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          galtan.z.gmc+
          galtan.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.galtan)
```

### Random

```{r}
mod3.galtan<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          galtan.z.gmc+
          galtan.z.gmc:gndr.c+
          (galtan.z.gmc+gndr.c+galtan.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.galtan)

anova(mod2.galtan,mod3.galtan)
```


## spendvtax

### Fixed

```{r}
mod2.spendvtax<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          spendvtax.z.gmc+
          spendvtax.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.spendvtax)
```

### Random

```{r}
mod3.spendvtax<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          spendvtax.z.gmc+
          spendvtax.z.gmc:gndr.c+
          (spendvtax.z.gmc+gndr.c+spendvtax.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.spendvtax)

anova(mod2.spendvtax,mod3.spendvtax)
```

## deregulation

### Fixed

```{r}
mod2.deregulation<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          deregulation.z.gmc+
          deregulation.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.deregulation)
```

### Random

```{r}
mod3.deregulation<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          deregulation.z.gmc+
          deregulation.z.gmc:gndr.c+
          (deregulation.z.gmc+gndr.c+deregulation.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.deregulation)

anova(mod2.deregulation,mod3.deregulation)
```


## redistribution

### Fixed

```{r}
mod2.redistribution<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          redistribution.z.gmc+
          redistribution.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.redistribution)
```

### Random

```{r}
mod3.redistribution<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          redistribution.z.gmc+
          redistribution.z.gmc:gndr.c+
          (redistribution.z.gmc+gndr.c+redistribution.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.redistribution)

anova(mod2.redistribution,mod3.redistribution)
```


## econ_interven

### Fixed

```{r}
mod2.econ_interven<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          econ_interven.z.gmc+
          econ_interven.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.econ_interven)
```

### Random

```{r}
mod3.econ_interven<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          econ_interven.z.gmc+
          econ_interven.z.gmc:gndr.c+
          (econ_interven.z.gmc+gndr.c+econ_interven.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.econ_interven)

anova(mod2.econ_interven,mod3.econ_interven)
```



## civlib_laworder

### Fixed

```{r}
mod2.civlib_laworder<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          civlib_laworder.z.gmc+
          civlib_laworder.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.civlib_laworder)
```

### Random

```{r}
mod3.civlib_laworder<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          civlib_laworder.z.gmc+
          civlib_laworder.z.gmc:gndr.c+
          (civlib_laworder.z.gmc+gndr.c+civlib_laworder.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.civlib_laworder)

anova(mod2.civlib_laworder,mod3.civlib_laworder)
```





## sociallifestyle

### Fixed

```{r}
mod2.sociallifestyle<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          sociallifestyle.z.gmc+
          sociallifestyle.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.sociallifestyle)
```

### Random

```{r}
mod3.sociallifestyle<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          sociallifestyle.z.gmc+
          sociallifestyle.z.gmc:gndr.c+
          (sociallifestyle.z.gmc+gndr.c+sociallifestyle.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.sociallifestyle)

anova(mod2.sociallifestyle,mod3.sociallifestyle)
```

## religious_principle

### Fixed

```{r}
mod2.religious_principle<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          religious_principle.z.gmc+
          religious_principle.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.religious_principle)
```

### Random

```{r}
mod3.religious_principle<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          religious_principle.z.gmc+
          religious_principle.z.gmc:gndr.c+
          (religious_principle.z.gmc+gndr.c+religious_principle.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.religious_principle)

anova(mod2.religious_principle,mod3.religious_principle)
```

## immigrate_policy

### Fixed

```{r}
mod2.immigrate_policy<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          immigrate_policy.z.gmc+
          immigrate_policy.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.immigrate_policy)
```

### Random

```{r}
mod3.immigrate_policy<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          immigrate_policy.z.gmc+
          immigrate_policy.z.gmc:gndr.c+
          (immigrate_policy.z.gmc+gndr.c+immigrate_policy.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.immigrate_policy)

anova(mod2.immigrate_policy,mod3.immigrate_policy)
```


## multiculturalism

### Fixed

```{r}
mod2.multiculturalism<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          multiculturalism.z.gmc+
          multiculturalism.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.multiculturalism)
```

### Random

```{r}
mod3.multiculturalism<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          multiculturalism.z.gmc+
          multiculturalism.z.gmc:gndr.c+
          (multiculturalism.z.gmc+gndr.c+multiculturalism.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.multiculturalism)

anova(mod2.multiculturalism,mod3.multiculturalism)
```


## urban_rural

### Fixed

```{r}
mod2.urban_rural<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          urban_rural.z.gmc+
          urban_rural.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.urban_rural)
```

### Random

```{r}
mod3.urban_rural<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          urban_rural.z.gmc+
          urban_rural.z.gmc:gndr.c+
          (urban_rural.z.gmc+gndr.c+urban_rural.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.urban_rural)

anova(mod2.urban_rural,mod3.urban_rural)
```



## environment

### Fixed

```{r}
mod2.environment<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          environment.z.gmc+
          environment.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.environment)
```

### Random

```{r}
mod3.environment<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          environment.z.gmc+
          environment.z.gmc:gndr.c+
          (environment.z.gmc+gndr.c+environment.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.environment)

anova(mod2.environment,mod3.environment)
```

## regions

### Fixed

```{r}
mod2.regions<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          regions.z.gmc+
          regions.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.regions)
```

### Random

```{r}
mod3.regions<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          regions.z.gmc+
          regions.z.gmc:gndr.c+
          (regions.z.gmc+gndr.c+regions.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.regions)

anova(mod2.regions,mod3.regions)
```


## international_security

### Fixed

```{r}
mod2.international_security<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          international_security.z.gmc+
          international_security.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.international_security)
```

### Random

```{r}
mod3.international_security<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          international_security.z.gmc+
          international_security.z.gmc:gndr.c+
          (international_security.z.gmc+gndr.c+international_security.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.international_security)

anova(mod2.international_security,mod3.international_security)
```



## ethnic_minorities

### Fixed

```{r}
mod2.ethnic_minorities<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          ethnic_minorities.z.gmc+
          ethnic_minorities.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.ethnic_minorities)
```

### Random

```{r}
mod3.ethnic_minorities<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          ethnic_minorities.z.gmc+
          ethnic_minorities.z.gmc:gndr.c+
          (ethnic_minorities.z.gmc+gndr.c+ethnic_minorities.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.ethnic_minorities)

anova(mod2.ethnic_minorities,mod3.ethnic_minorities)
```


## nationalism

### Fixed

```{r}
mod2.nationalism<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          nationalism.z.gmc+
          nationalism.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.nationalism)
```

### Random

```{r}
mod3.nationalism<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          nationalism.z.gmc+
          nationalism.z.gmc:gndr.c+
          (nationalism.z.gmc+gndr.c+nationalism.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.nationalism)

anova(mod2.nationalism,mod3.nationalism)
```


## antielite_salience

### Fixed

```{r}
mod2.antielite_salience<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          antielite_salience.z.gmc+
          antielite_salience.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.antielite_salience)
```

### Random

```{r}
mod3.antielite_salience<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          antielite_salience.z.gmc+
          antielite_salience.z.gmc:gndr.c+
          (antielite_salience.z.gmc+gndr.c+antielite_salience.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.antielite_salience)

anova(mod2.antielite_salience,mod3.antielite_salience)
```

## corrupt_salience

### Fixed

```{r}
mod2.corrupt_salience<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          corrupt_salience.z.gmc+
          corrupt_salience.z.gmc:gndr.c+
          (1|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight)
summary(mod2.corrupt_salience)
```

### Random

```{r}
mod3.corrupt_salience<-
  glmer(childlessness~gndr.c+age10.c+minority.c+
          corrupt_salience.z.gmc+
          corrupt_salience.z.gmc:gndr.c+
          (corrupt_salience.z.gmc+gndr.c+corrupt_salience.z.gmc:gndr.c|cntry),
        data=exdat,
        family=binomial(link="logit"),weights = anweight,
        control = glmerControl(optimizer="bobyqa",
                               optCtrl=list(maxfun=2e6)))
summary(mod3.corrupt_salience)

anova(mod2.corrupt_salience,mod3.corrupt_salience)
```

# Session Information

```{r}
sinf<-sessionInfo()
print(sinf,locale=F)
```


